/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function e(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}var Datepikcer=function(){function r(t,a){_classCallCheck(this,r),this.date=new Date,this._reset(),this.today=parseInt(this.arr[0].y+""+this.arr[0].m+this.arr[0].d),this.time=!1,this.picker=null,this.input=t,this.inputDom=scope(this.input),this.index=0,this.pindex=null,this.currentNum=0,this.focusInput=null;if(this.param=$.extend({type:"date",format:"Y-m-d",confirm:!1,change:null,start:0,end:0,quick:!1,unixtime:!1,default:[]},a),0==this.inputDom.length)return console.log("当前页面中不包含"+this.input+"元素，创建日历失败"),!1;this.run()}return _createClass(r,[{key:"run",value:function(){this._create(),this._init(),this._event()}},{key:"_create",value:function(){var t=createId(),a='<div id="datepicker-'+t+'" class="datepicker animated faster'+(null==Mount.window?"":" "+Mount.window)+'">';a+='<div class="quick">\n\t\t\t<span class="title">快捷选择</span>\n\t\t\t<span>3天内</span>\n\t\t\t<span>一周内</span>\n\t\t\t<span>15天内</span>\n\t\t\t<span>一月内</span>\n\t\t\t<span>三月内</span>\n\t\t\t<span>一年内</span>\n\t\t</div>\n\t\t<div class="datepicker-panel" data-index="0">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>',a+='</div>\n\t\t\t<div class="body">\n\t\t\t\t<div class="week">\n\t\t\t\t\t'+this._week()+'\n\t\t\t\t</div>\n\t\t\t\t<div class="day"></div>',a+='<div class="y-m">\n\t\t\t'+this._year()+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month()+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(a+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),a+="</div></div>",a+='<div class="datepicker-panel right" data-index="1">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="body">\n\t\t\t<div class="week">\n\t\t\t\t'+this._week()+'\n\t\t\t</div>\n\t\t\t<div class="day"></div>',a+='<div class="y-m">\n\t\t\t'+this._year(parseInt(this.arr[0].m)+1)+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month(parseInt(this.arr[0].m)+1)+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(a+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),a+="</div></div>",a+='<div class="clear"></div>',a+='<div class="footer">\n\t\t\t<span class="font choose-time">\n\t\t\t\t选择时间\n\t\t\t</span>\n\t\t\t<span class="confirm">\n\t\t\t\t<button class="clear small">清空</button>\n\t\t\t\t<button class="highlight small sure">确定</button>\n\t\t\t</span>\n\t\t</div>',a+="</div>",body.append(a),this.picker=$("#datepicker-"+t)}},{key:"_init",value:function(){var r=this;if(this.param.quick&&this.picker.find(".quick").show(),-1!=this.param.format.indexOf(" ")&&(this.time=!0),0<this.param.default.length){var t,a="";for(t in _.isNumber(this.param.default[0])&&10==(this.param.default[0]+"").length&&(a=_.replace(this.param.format,"Y","%y"),a=_.replace(a,"m","%M"),a=_.replace(a,"d","%d"),this.time&&(a=_.replace(a,"H","%h"),a=_.replace(a,"i","%m"),a=_.replace(a,"s","%s"))),this.param.default)""!=a&&(this.param.default[t]=Time(this.param.default[t],a));this.inputDom.val(_.join(this.param.default," - ")).data("default-date",_.join(this.param.default,","))}var e={val:this.inputDom.val(),picker:this.picker.children("div").eq(1)};e.header=e.picker.children(".header");var i=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.header,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.arr[0].y;t.find(".year").data("y",a).html(a+"年")},n=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.header,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.arr[0].m;t.find(".month").data("m",a).html(a+"月")};i(),n(),e.picker.find(".day").html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(e.range=e.picker.next(),e.range.show(),e.rangeHeader=e.range.children(".header"),i(e.rangeHeader,this.arr[1].y),n(e.rangeHeader,this.arr[1].m),e.range.find(".day").html(this._createYmdHtml(this.arr[1].y,this.arr[1].m))),this.param.confirm&&this.picker.find(".footer").show(),this.time&&(e.chooseTime=this.picker.find(".choose-time"),e.chooseTime.show(),e.arr=_.words(this.param.format,/[His]/g),e.arr.length<2?console.log("日期如果包含时间的话则至少需要时和分两个参数"):(""!=e.val&&(e.picker.find(".h"+this.h).addClass("current"),e.picker.find(".i"+this.i).addClass("current"),e.picker.find(".s"+this.s).addClass("current")),2==e.arr.length&&(e.picker.find(".picker-time ul:last").remove(),"date-range"==this.param.type&&e.range.find(".picker-time ul:last").remove())))}},{key:"_reset",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.arr=[{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:0},{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:1}],this.arr[1].m+=1,12==this.arr[1].m&&(this.arr[1].y+=1,this.arr[1].m=0),this.arr[0].m=repairZero(parseInt(this.arr[0].m)+1),this.arr[0].d=repairZero(this.arr[0].d),this.arr[1].m=repairZero(parseInt(this.arr[1].m)+1),this.arr[1].d=repairZero(this.arr[1].d),t&&((t={ym:this.picker.find(".show-ym"),day:this.picker.find(".day")}).y=t.ym.eq(0).children(".year"),t.m=t.ym.eq(0).children(".month"),t.y.data("y")!=this.arr[0].y&&t.y.html(this.arr[0].y+"年").data("y",this.arr[0].y),t.m.data("m")!=this.arr[0].m&&t.m.html(this.arr[0].m+"月").data("m",this.arr[0].m),t.y==this.arr[0].y&&t.m==this.arr[0].m||t.day.eq(0).html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(t.y=t.ym.eq(1).children(".year"),t.m=t.ym.eq(1).children(".month"),t.y.data("y")!=this.arr[1].y&&t.y.html(this.arr[1].y+"年").data("y",this.arr[1].y),t.m.data("m")!=this.arr[1].m&&t.m.html(this.arr[1].m+"月").data("m",this.arr[1].m),t.y==this.arr[1].y&&t.m==this.arr[1].m||t.day.eq(1).html(this._createYmdHtml(this.arr[1].y,this.arr[1].m))))}},{key:"_createYmdHtml",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=parseInt(a)-1,e={firstWeekDay:new Date(t,r,1).getDay(),monthDay:this._getMonthDay(t,r),prevMonthDay:this._getMonthDay(t,r-1),realDay:1,start:this.param.start?parseInt(this.param.start):0,end:this.param.end?parseInt(this.param.end):0,html:""};e.firstWeekDay+=1;for(var i=1;i<43;i++){var n,s="",d="",l=0;i<e.firstWeekDay?(e.realDay=e.prevMonthDay-(e.firstWeekDay-i),e.realDay+=1,d=' class="next"'):i-e.firstWeekDay>=e.monthDay?(i-e.firstWeekDay==e.monthDay&&(e.realDay=1),d=' class="next"'):((l=parseInt(t+""+a+repairZero(i-e.firstWeekDay+1)))==this.today&&(s="<div></div>"),"date"==this.param.type?l==this.arr[this.index].c&&(d=' class="current"'):(this.arr[this.index].index==this.index&&this.arr[this.index].c==l&&(d=' class="current"'),n=1==this.index?0:1,this.arr[n].index==this.index&&this.arr[n].c==l&&(d=' class="current"')),i==e.firstWeekDay&&(e.realDay=1)),(0<e.start||0<e.end)&&' class="next"'!=d&&(0<e.start&&l<e.start&&(d=' class="next"'),0<e.end&&l>e.end&&(d=' class="next"')),e.html+="<span"+d+' data-day="'+l+'" data-y="'+t+'" data-m="'+a+'" data-d="'+e.realDay+'">\n\t\t\t\t\t\t\t'+s+e.realDay+"\n\t\t\t\t\t\t</span>",e.realDay++}return e.html}},{key:"_getMonthDay",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=(a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")<0?11:a,r=t%4==0&&t%100!=0||t%400==0?29:28,t=new Array;return t[0]=31,t[1]=r,t[2]=31,t[3]=30,t[4]=31,t[5]=30,t[6]=31,t[7]=31,t[8]=30,t[9]=31,t[10]=30,t[11]=31,t[a]}},{key:"_week",value:function(){var t,a="",r=["日","一","二","三","四","五","六"];for(t in r)a+="<span>"+r[t]+"</span>";return a}},{key:"_year",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=parseInt(this.arr[0].y);12===t&&(a+=1);for(var r="",e=a+1;e>parseInt(this.arr[0].y)-11;e--)r+='<div class="year'+(a==e?" active":"")+'" data-y="'+e+'">'+e+"</div>";return r}},{key:"_month",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=""==t?+this.arr[0].m:t;12<a&&(a=1);for(var r="",e=1;e<13;e++)r+='<div class="month'+(a==e?" active":"")+'" data-m="'+e+'">'+e+"月</div>";return r}},{key:"_time",value:function(){for(var t='<ul class="iscroll">',a=0;a<24;a++)t+='<li class="h'+(a=repairZero(a))+' h">'+a+"</li>";t+='</ul><ul class="i iscroll">';for(var r=0;r<60;r++)t+='<li class="i'+(r=repairZero(r))+' i">'+r+"</li>";t+='</ul><ul class="s iscroll">';for(var e=0;e<60;e++)t+='<li class="s'+(e=repairZero(e))+' s">'+e+"</li>";return t+="</ul>"}},{key:"_event",value:function(){var t=[".prev-year, .prev-month, .next-year, .next-month",".show-ym .year, .show-ym .month",".y-m div",".day span",".footer .clear",".footer .sure",".footer .choose-time",".picker-time li",".quick span"],h=this;h.inputDom.on("focus",function(){var t=$(this);fadeIn(h.picker,t,!1),h.focusInput=t,clear=!0}).on("blur",function(){fadeOut(h.picker),h.focusInput=null,clear=!1}),this.picker.on("blur",function(){h.focusInput.blur(),h.focusInput=null,fadeOut(h.picker),clear=!1}).on("mouseenter",">.datepicker-panel",function(){h.index=$(this).data("index")}).on("click",t[0],function(){var t=$(this),a={body:t.parent().next(".body"),ym:t.siblings(".show-ym")};a.y=a.ym.children(".year").data("y"),a.m=parseInt(a.ym.children(".month").data("m"));var r=function(){a.ym.children(".year").data("y",a.y).html(a.y+"年")};t.hasClass("prev-year")?(--a.y,r()):t.hasClass("prev-month")?(--a.m,0==a.m&&(--a.y,a.m=12,r()),a.ym.children(".month").html(repairZero(a.m)+"月").data("m",a.m)):t.hasClass("next-year")?(a.y+=1,r()):(a.m+=1,13==a.m&&(a.y+=1,a.m=1,r()),a.ym.children(".month").html(repairZero(a.m)+"月").data("m",a.m)),a.body.children(".day").html(h._createYmdHtml(a.y,repairZero(a.m)))}).on("click",t[1],function(){var t=$(this);t.parent().children(".month").hide();var a=t.parent().parent().next(".body");a.children("div").hide();t=$(this).hasClass("year")?2:3;a.children().eq(t).css("display","flex")}).on("click",t[2],function(){var t,a,r=$(this),e=r.parent().parent(),i=e.prev();r.hasClass("year")?(a=r.data("y"),i.find(".year").html(a+"年").data("y",a),r.parent().hide().next().css("display","flex")):(t=i.find(".year").data("y"),a=r.data("m"),r.parent().hide().siblings(".week, .day").css("display","flex"),i.find(".month").html(repairZero(a)+"月").data("m",a).show(),e.children(".day").html(h._createYmdHtml(t,repairZero(a)))),addClassExc(r,"active")}).on("click",t[3],function(){var t=$(this);if(!t.hasClass("next")){if("date-range"==h.param.type){var a=h.index;if(h.arr[a].y=t.data("y"),h.arr[a].m=t.data("m"),h.arr[a].index=h.index,h.currentNum+=1,3==h.currentNum&&(h.picker.find(".current").removeClass("current"),h.currentNum=1,h.pindex=null),t.addClass("current"),null==h.pindex?h.pindex=a:a==h.pindex&&(a=0==h.pindex?1:0,h.arr[a].y=h.arr[h.pindex].y,h.arr[a].m=h.arr[h.pindex].m,h.arr[a].index=h.index),h.arr[a].d=repairZero(t.data("d")),h.arr[a].c=parseInt(t.data("day")),1==h.currentNum||3==h.currentNum)return}else h.arr[0].y=t.data("y"),h.arr[0].m=t.data("m"),h.arr[0].d=repairZero(t.data("d")),h.arr[0].c=parseInt(t.data("day")),addClassExc(t,"current");h.param.confirm||h._setVal()}}).on("click",t[4],function(){h.inputDom.val(""),h.picker.find(".current").removeClass("current"),h._reset(!0),h.focus=!1,h.picker.trigger("blur")}).on("click",t[5],function(){h._setVal()}).on("click",t[6],function(){var t=$(this);if(t.hasClass("not-allow"))return!1;var a=t.data("type");if(null==a||0==a)return t.data("type",1).html("选择日期"),void $(h.picker).find(".body > div").hide().siblings(".picker-time").css("display","flex");t.data("type",0).html("选择时间"),$(h.picker).find(".body > .week, .body > .day").css("display","flex").siblings(".picker-time").hide()}).on("click",t[7],function(){var t=$(this),a=t.position().top+t.parent()[0].scrollTop;h.time&&(t.hasClass("h")?h.arr[h.index].h=t.html():t.hasClass("i")?h.arr[h.index].i=t.html():h.arr[h.index].s=t.html()),t.addClass("current").siblings().removeClass("current").parent().animate({scrollTop:a},200),2!=t.parent().index()&&t.parent().next("ul").children("li:first").trigger("click")}).on("click",t[8],function(){var t=$(this);if(0!=t.index()&&!t.hasClass("current")){var e=h.date.getFullYear(),i=repairZero(h.date.getMonth()+1),a=h.date.getDate(),r=0;switch(t.index()){case 1:r=3;break;case 2:r=7;break;case 3:r=15;break;case 4:r=30;break;case 5:r=90;break;case 6:r=365}var n=Date.parse((new Date).toString())-864e5*r,s=new Date(n),d=s.getFullYear(),l=repairZero(s.getMonth()+1),n=s.getDate(),s=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;h.index=0;var a=h._createYmdHtml(d,l);h.picker.children("div").eq(1).find(".day").html(a),h.picker.find(".show-ym:first").children(".year").html(d+"年").data("y",d).next().html(l+"月").data("m",l),h.index=1;var r=e,t=parseInt(i)+t;12<t&&(r+=t=1),t=repairZero(t),a=h._createYmdHtml(r,t),h.picker.children("div").eq(2).find(".day").html(a),h.picker.find(".show-ym:last").children(".year").html(r+"年").data("y",r).next().html(t+"月").data("m",t)};addClassExc(t,"current"),h.picker.find(".day .current").removeClass("current"),d==e&&l==i?(h.picker.find(".day:first").children('[data-d="'+a+'"]:not(.next),[data-d="'+n+'"]:not(.next)').addClass("current"),h.arr[0].y=d,h.arr[0].m=i,n=repairZero(n),h.arr[0].d=n,h.arr[0].c=parseInt(e+""+i+n),h.arr[1].y=e,h.arr[1].m=i,a=repairZero(a),h.arr[1].d=a,h.arr[1].c=parseInt(e+""+i+a),h.arr[1].index=0,h.pindex=0,(t=h.picker.find(".show-ym:first")).children(".year").data("y")==e&&t.children(".month").data("m")==i||s(1)):(h.arr[0].y=d,h.arr[0].m=l,n=repairZero(n),h.arr[0].d=n,h.arr[0].c=parseInt(d+""+l+n),h.arr[1].y=e,h.arr[1].m=i,a=repairZero(a),h.arr[1].d=a,h.arr[1].c=parseInt(e+""+i+a),h.arr[1].index=1,h.pindex=1,s()),h.currentNum=2,h.param.confirm||h._setVal()}}).on("mousedown",function(t){t.preventDefault()})}},{key:"_setVal",value:function(){var t,r=this,a="",e=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t={index:r.arr[t],val:""};return t.m=t.index.m,t.d=t.index.d,0==a?(t.val=_.replace(r.param.format,"Y",t.index.y),t.val=_.replace(t.val,"m",t.m),t.val=_.replace(t.val,"d",t.d),r.time&&(t.val=_.replace(t.val,"H",t.index.h),t.val=_.replace(t.val,"i",t.index.i),t.val=_.replace(t.val,"s",t.index.s)),t.val):(t.val=t.index.y+""+t.m+t.d,parseInt(t.val))};"date"==this.param.type?(a=e(),0==this.arr[0].c&&(this.arr[this.index].c=e(0,1),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current")),this.focusInput.val(a),this.param.unixtime&&(this.time||(a+=" 00:00:00"),a=Date.parse(new Date(a))/1e3),0==this.focusInput.next("input").length?null==(t=this.focusInput.attr("name"))?console.log("没有为日期文本框指定name属性，这将影响后端取值"):this.focusInput.removeAttr("name").after('<input type="hidden" name="'+t+'" value="'+a+'">'):this.focusInput.next("input").val(a)):(this.pindex=null,0!=this.arr[0].c&&0!=this.arr[1].c||(0==this.arr[0].c&&(this.arr[0].c=e(0,1)),0==this.arr[1].c&&(this.arr[1].c=e(1,1)),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current"),this.currentNum=2),t=this.arr[0].c>this.arr[1].c?e(1):e(),e=this.arr[0].c>this.arr[1].c?e():e(1),this.focusInput.val(a+=t+" - "+e),this.param.unixtime&&(this.time||(t+=" 00:00:00",e+=" 23:59:59"),t=Date.parse(new Date(t))/1e3,e=Date.parse(new Date(e))/1e3),a=t+","+e,0==this.focusInput.next("input").length?null==(e=this.focusInput.attr("name"))?console.log("没有为日期文本框指定name属性，这将影响后端取值"):this.focusInput.removeAttr("name").after('<input type="hidden" name="'+e+'" value="'+a+'">'):this.focusInput.next("input").val(a)),this.focus=!1,this.picker.trigger("blur"),1<this.inputDom.length&&this._reset(!0),_.isFunction(this.param.change)&&this.param.change(a)}}]),r}();