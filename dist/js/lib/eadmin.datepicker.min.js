/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function e(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}var Datepikcer=function(){function r(t,a){_classCallCheck(this,r),this.date=new Date,this._reset(),this.today=parseInt(this.arr[0].y+""+this.arr[0].m+this.arr[0].d),this.time=!1,this.picker=null,this.input=t,this.inputDom=scope(this.input),this.index=0,this.pindex=null,this.currentNum=0;this.focusInput=null;if(this.param=$.extend({type:"date",format:"Y-m-d",confirm:!1,change:null,start:0,end:0,quick:!1},a),0==this.inputDom.length)return console.log("当前页面中不包含"+this.input+"元素，创建日历失败"),!1;this.run()}return _createClass(r,[{key:"run",value:function(){this._create(),this._init(),this._event()}},{key:"_create",value:function(){var t=createId(),a='<div id="datepicker-'+t+'" class="datepicker animated faster'+(null==Mount.window?"":" "+Mount.window)+'">';a+='<div class="quick">\n\t\t\t<span class="title">快捷选择</span>\n\t\t\t<span>3天内</span>\n\t\t\t<span>一周内</span>\n\t\t\t<span>15天内</span>\n\t\t\t<span>一月内</span>\n\t\t\t<span>三月内</span>\n\t\t\t<span>一年内</span>\n\t\t</div>\n\t\t<div class="datepicker-panel" data-index="0">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="body">\n\t\t\t<div class="week">\n\t\t\t\t'+this._week()+'\n\t\t\t</div>\n\t\t\t<div class="day"></div>',a+='<div class="y-m">\n\t\t\t'+this._year()+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month()+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(a+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),a+="</div></div>",a+='<div class="datepicker-panel right" data-index="1">\n\t\t<div class="header">\n\t\t\t<span class="prev-year">\n\t\t\t\t<i class="ri-arrow-left-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="prev-month">\n\t\t\t\t<i class="ri-arrow-drop-left-line"></i>\n\t\t\t</span>\n\t\t\t<span class="show-ym">\n\t\t\t\t<span class="font year" style="margin-right:5px;"></span>\n\t\t\t\t<span class="font month"></span>\n\t\t\t</span>\n\t\t\t<span class="next-year">\n\t\t\t\t<i class="ri-arrow-right-s-line"></i>\n\t\t\t</span>\n\t\t\t<span class="next-month">\n\t\t\t\t<i class="ri-arrow-drop-right-line"></i>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="body">\n\t\t\t<div class="week">\n\t\t\t\t'+this._week()+'\n\t\t\t</div>\n\t\t\t<div class="day"></div>',a+='<div class="y-m">\n\t\t\t'+this._year(this.arr[0].m+1)+'\n\t\t</div>\n\t\t<div class="y-m">\n\t\t\t'+this._month(this.arr[0].m+1)+"\n\t\t</div>",-1!=this.param.format.indexOf(" ")&&(a+='<div class="picker-time">\n\t\t\t\t\t\t'+this._time()+"\n\t\t\t\t\t</div>"),a+="</div></div>",a+='<div class="clear"></div>',a+='<div class="footer">\n\t\t\t<span class="font choose-time">\n\t\t\t\t选择时间\n\t\t\t</span>\n\t\t\t<span class="confirm">\n\t\t\t\t<button class="clear small">清空</button>\n\t\t\t\t<button class="highlight small sure">确定</button>\n\t\t\t</span>\n\t\t</div>',a+="</div>",body.append(a),this.picker=$("#datepicker-"+t)}},{key:"_init",value:function(){var r=this;this.param.quick&&this.picker.find(".quick").show(),-1!=this.param.format.indexOf(" ")&&(this.time=!0);var e={val:this.inputDom.val(),picker:this.picker.children("div").eq(1)};e.header=e.picker.children(".header");var t=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.header,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.arr[0].y;t.find(".year").data("y",a).html(a+"年")},a=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.header,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.arr[0].m;t.find(".month").data("m",a).html(a+"月")};t(),a(),e.picker.find(".day").html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(e.range=e.picker.next(),e.range.show(),e.rangeHeader=e.range.children(".header"),t(e.rangeHeader,this.arr[1].y),a(e.rangeHeader,this.arr[1].m),e.range.find(".day").html(this._createYmdHtml(this.arr[1].y,this.arr[1].m))),this.param.confirm&&this.picker.find(".footer").show(),this.time&&(e.chooseTime=this.picker.find(".choose-time"),e.chooseTime.show(),e.arr=_.words(this.param.format,/[His]/g),e.arr.length<2?console.log("日期如果包含时间的话则至少需要时和分两个参数"):(""!=e.val&&(e.picker.find(".h"+this.h).addClass("current"),e.picker.find(".i"+this.i).addClass("current"),e.picker.find(".s"+this.s).addClass("current")),2==e.arr.length&&(e.picker.find(".picker-time ul:last").remove(),"date-range"==this.param.type&&e.range.find(".picker-time ul:last").remove())))}},{key:"_reset",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.arr=[{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:0},{y:this.date.getFullYear(),m:this.date.getMonth(),d:this.date.getDate(),h:"00",i:"00",s:"00",c:0,index:1}],this.arr[1].m+=1,12==this.arr[1].m&&(this.arr[1].y+=1,this.arr[1].m=0),this.arr[0].m=repairZero(parseInt(this.arr[0].m)+1),this.arr[0].d=repairZero(this.arr[0].d),this.arr[1].m=repairZero(parseInt(this.arr[1].m)+1),this.arr[1].d=repairZero(this.arr[1].d),t){var a={ym:this.picker.find(".show-ym"),day:this.picker.find(".day")};a.y=a.ym.eq(0).children(".year"),a.m=a.ym.eq(0).children(".month"),a.y.data("y")!=this.arr[0].y&&a.y.html(this.arr[0].y+"年").data("y",this.arr[0].y),a.m.data("m")!=this.arr[0].m&&a.m.html(this.arr[0].m+"月").data("m",this.arr[0].m),a.y==this.arr[0].y&&a.m==this.arr[0].m||a.day.eq(0).html(this._createYmdHtml(this.arr[0].y,this.arr[0].m)),"date-range"==this.param.type&&(a.y=a.ym.eq(1).children(".year"),a.m=a.ym.eq(1).children(".month"),a.y.data("y")!=this.arr[1].y&&a.y.html(this.arr[1].y+"年").data("y",this.arr[1].y),a.m.data("m")!=this.arr[1].m&&a.m.html(this.arr[1].m+"月").data("m",this.arr[1].m),a.y==this.arr[1].y&&a.m==this.arr[1].m||a.day.eq(1).html(this._createYmdHtml(this.arr[1].y,this.arr[1].m)))}}},{key:"_createYmdHtml",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=parseInt(a)-1,e={firstWeekDay:new Date(t,r,1).getDay(),monthDay:this._getMonthDay(t,r),prevMonthDay:this._getMonthDay(t,r-1),realDay:1,start:this.param.start?parseInt(this.param.start):0,end:this.param.end?parseInt(this.param.end):0,html:""};e.firstWeekDay+=1;for(var i=1;i<43;i++){var n="",s="",d=0;if(i<e.firstWeekDay)e.realDay=e.prevMonthDay-(e.firstWeekDay-i),e.realDay+=1,s=' class="next"';else if(i-e.firstWeekDay>=e.monthDay)i-e.firstWeekDay==e.monthDay&&(e.realDay=1),s=' class="next"';else{if((d=parseInt(t+""+a+repairZero(i-e.firstWeekDay+1)))==this.today&&(n="<div></div>"),"date"==this.param.type)d==this.arr[this.index].c&&(s=' class="current"');else{this.arr[this.index].index==this.index&&this.arr[this.index].c==d&&(s=' class="current"');var l=1==this.index?0:1;this.arr[l].index==this.index&&this.arr[l].c==d&&(s=' class="current"')}i==e.firstWeekDay&&(e.realDay=1)}(0<e.start||0<e.end)&&' class="next"'!=s&&(0<e.start&&d<e.start&&(s=' class="next"'),0<e.end&&d>e.end&&(s=' class="next"')),e.html+="<span"+s+' data-day="'+d+'" data-y="'+t+'" data-m="'+a+'" data-d="'+e.realDay+'">\n\t\t\t\t\t\t\t'+n+e.realDay+"\n\t\t\t\t\t\t</span>",e.realDay++}return e.html}},{key:"_getMonthDay",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";a=a<0?11:a;var r=t%4==0&&t%100!=0||t%400==0?29:28,e=new Array;return e[0]=31,e[1]=r,e[2]=31,e[3]=30,e[4]=31,e[5]=30,e[6]=31,e[7]=31,e[8]=30,e[9]=31,e[10]=30,e[11]=31,e[a]}},{key:"_week",value:function(){var t="",a=["日","一","二","三","四","五","六"];for(var r in a)t+="<span>"+a[r]+"</span>";return t}},{key:"_year",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=void 0;""==t?a=this.arr[0].y:12==t&&(a=this.arr[0].y+1);for(var r="",e=this.arr[0].y+1;e>this.arr[0].y-11;e--){r+='<div class="year'+(a==e?" active":"")+'" data-y="'+e+'">'+e+"</div>"}return r}},{key:"_month",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=""==t?parseInt(this.arr[0].m):t;12<a&&(a=1);for(var r="",e=1;e<13;e++){r+='<div class="month'+(a==e?" active":"")+'" data-m="'+e+'">'+e+"月</div>"}return r}},{key:"_time",value:function(){for(var t='<ul class="iscroll">',a=0;a<24;a++)t+='<li class="h'+(a=repairZero(a))+' h">'+a+"</li>";t+='</ul><ul class="i iscroll">';for(var r=0;r<60;r++)t+='<li class="i'+(r=repairZero(r))+' i">'+r+"</li>";t+='</ul><ul class="s iscroll">';for(var e=0;e<60;e++)t+='<li class="s'+(e=repairZero(e))+' s">'+e+"</li>";return t+="</ul>"}},{key:"_event",value:function(){var t=[".prev-year, .prev-month, .next-year, .next-month",".show-ym .year, .show-ym .month",".y-m div",".day span",".footer .clear",".footer .sure",".footer .choose-time",".picker-time li",".quick span"],m=this;m.inputDom.on("focus",function(){var t={this:$(this)};fadeIn(m.picker,t.this,!1),m.focusInput=t.this,clear=!0}).on("blur",function(){fadeOut(m.picker),m.focusInput=null,clear=!1}),this.picker.on("blur",function(){m.focusInput.blur(),m.focusInput=null,fadeOut(m.picker),clear=!1}).on("mouseenter",">.datepicker-panel",function(){m.index=$(this).data("index")}).on("click",t[0],function(){var t=$(this),a={body:t.parent().next(".body"),ym:t.siblings(".show-ym")};a.y=a.ym.children(".year").data("y"),a.m=parseInt(a.ym.children(".month").data("m"));var r=function(){a.ym.children(".year").data("y",a.y).html(a.y+"年")};t.hasClass("prev-year")?(a.y-=1,r()):t.hasClass("prev-month")?(a.m-=1,0==a.m&&(a.y-=1,a.m=12,r()),a.ym.children(".month").html(repairZero(a.m)+"月").data("m",a.m)):$(this).hasClass("next-year")?(a.y+=1,r()):(a.m+=1,13==a.m&&(a.y+=1,a.m=1,r()),a.ym.children(".month").html(repairZero(a.m)+"月").data("m",a.m)),a.body.children(".day").html(m._createYmdHtml(a.y,repairZero(a.m)))}).on("click",t[1],function(){var t=$(this);t.parent().children(".month").hide();var a=t.parent().parent().next(".body");a.children("div").hide();var r=$(this).hasClass("year")?2:3;a.children().eq(r).css("display","flex")}).on("click",t[2],function(){var t=$(this),a=t.parent().parent(),r=a.prev();if(t.hasClass("year")){var e=t.data("y");r.find(".year").html(e+"年").data("y",e),t.parent().hide().next().css("display","flex")}else{var i=r.find(".year").data("y"),n=t.data("m");t.parent().hide().siblings(".week, .day").css("display","flex"),r.find(".month").html(repairZero(n)+"月").data("m",n).show(),a.children(".day").html(m._createYmdHtml(i,repairZero(n)))}t.addClass("active").siblings().removeClass("active")}).on("click",t[3],function(){var t=$(this);if(!t.hasClass("next")){if("date-range"==m.param.type){var a=m.index;if(m.arr[a].y=t.data("y"),m.arr[a].m=t.data("m"),m.arr[a].index=m.index,m.currentNum+=1,3==m.currentNum&&(m.picker.find(".current").removeClass("current"),m.currentNum=1,m.pindex=null),t.addClass("current"),null==m.pindex?m.pindex=a:a==m.pindex&&(a=0==m.pindex?1:0,m.arr[a].y=m.arr[m.pindex].y,m.arr[a].m=m.arr[m.pindex].m,m.arr[a].index=m.index),m.arr[a].d=repairZero(t.data("d")),m.arr[a].c=parseInt(t.data("day")),1==m.currentNum||3==m.currentNum)return}else m.arr[0].y=t.data("y"),m.arr[0].m=t.data("m"),m.arr[0].d=repairZero(t.data("d")),m.arr[0].c=parseInt(t.data("day")),t.addClass("current").siblings().removeClass("current");m.param.confirm||m._setVal()}}).on("click",t[4],function(){m.inputDom.val(""),m.picker.find(".current").removeClass("current"),m._reset(!0),m.focus=!1,m.picker.trigger("blur")}).on("click",t[5],function(){m._setVal()}).on("click",t[6],function(){var t=$(this);if(t.hasClass("not-allow"))return!1;var a=t.data("type");if(null==a||0==a)return t.data("type",1).html("选择日期"),void $(m.picker).find(".body > div").hide().siblings(".picker-time").css("display","flex");t.data("type",0).html("选择时间"),$(m.picker).find(".body > .week, .body > .day").css("display","flex").siblings(".picker-time").hide()}).on("click",t[7],function(){var t=$(this),a=t.position().top+t.parent()[0].scrollTop;m.time&&(t.hasClass("h")?m.arr[m.index].h=t.html():t.hasClass("i")?m.arr[m.index].i=t.html():m.arr[m.index].s=t.html()),t.addClass("current").siblings().removeClass("current").parent().animate({scrollTop:a},200),2!=t.parent().index()&&t.parent().next("ul").children("li:first").trigger("click")}).on("click",t[8],function(){var t=$(this);if(0!=t.index()&&!t.hasClass("current")){var i=m.date.getFullYear(),n=repairZero(m.date.getMonth()+1),a=m.date.getDate(),r=0;switch(t.index()){case 1:r=3;break;case 2:r=7;break;case 3:r=15;break;case 4:r=30;break;case 5:r=90;break;case 6:r=365}var e=Date.parse((new Date).toString())-864e5*r,s=new Date(e),d=s.getFullYear(),l=repairZero(s.getMonth()+1),h=s.getDate(),c=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;m.index=0;var a=m._createYmdHtml(d,l);m.picker.children("div").eq(1).find(".day").html(a),m.picker.find(".show-ym:first").children(".year").html(d+"年").data("y",d).next().html(l+"月").data("m",l),m.index=1;var r=i,e=parseInt(n)+t;12<e&&(r+=e=1),e=repairZero(e),a=m._createYmdHtml(r,e),m.picker.children("div").eq(2).find(".day").html(a),m.picker.find(".show-ym:last").children(".year").html(r+"年").data("y",r).next().html(e+"月").data("m",e)};if(t.addClass("current").siblings().removeClass("current"),m.picker.find(".day .current").removeClass("current"),d==i&&l==n){m.picker.find(".day:first").children('[data-d="'+a+'"]:not(.next),[data-d="'+h+'"]:not(.next)').addClass("current"),m.arr[0].y=d,m.arr[0].m=n,h=repairZero(h),m.arr[0].d=h,m.arr[0].c=parseInt(i+""+n+h),m.arr[1].y=i,m.arr[1].m=n,a=repairZero(a),m.arr[1].d=a,m.arr[1].c=parseInt(i+""+n+a),m.arr[1].index=0,m.pindex=0;var o=m.picker.find(".show-ym:first");o.children(".year").data("y")==i&&o.children(".month").data("m")==n||c(1)}else m.arr[0].y=d,m.arr[0].m=l,m.arr[0].d=h,m.arr[0].c=parseInt(d+""+l+repairZero(h)),m.arr[1].y=i,m.arr[1].m=n,m.arr[1].d=a,m.arr[1].c=parseInt(i+""+n+repairZero(a)),m.arr[1].index=1,m.pindex=1,c();m.currentNum=2,m.param.confirm||m._setVal()}}).on("mousedown",function(t){t.preventDefault()})}},{key:"_setVal",value:function(){var e=this,t="",a=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r={index:e.arr[t],val:""};return r.m=r.index.m,r.d=r.index.d,0==a?(r.val=_.replace(e.param.format,"Y",r.index.y),r.val=_.replace(r.val,"m",r.m),r.val=_.replace(r.val,"d",r.d),e.time&&(r.val=_.replace(r.val,"H",r.index.h),r.val=_.replace(r.val,"i",r.index.i),r.val=_.replace(r.val,"s",r.index.s)),r.val):(r.val=r.index.y+""+r.m+r.d,parseInt(r.val))};"date"==this.param.type?(t=a(),0==this.arr[0].c&&(this.arr[this.index].c=a(0,1),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current"))):(this.pindex=null,0!=this.arr[0].c&&0!=this.arr[1].c||(0==this.arr[0].c&&(this.arr[0].c=a(0,1)),0==this.arr[1].c&&(this.arr[1].c=a(1,1)),this.picker.find(".day").find('span[data-d="'+parseInt(this.arr[0].d)+'"]:not(.next)').addClass("current"),this.currentNum=2),t+=this.arr[0].c>this.arr[1].c?a(1):a(),t+=" - ",t+=this.arr[0].c>this.arr[1].c?a():a(1)),this.focus=!1,this.focusInput.val(t),this.picker.trigger("blur"),1<this.inputDom.length&&this._reset(!0),null!=this.param.change&&_.isFunction(this.param.change)&&this.param.change(t)}}]),r}();