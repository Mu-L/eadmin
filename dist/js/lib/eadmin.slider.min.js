/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Slider=function(){function i(t){var e=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,i),this.dom=t,this.domCache=scope(this.dom),0!=this.domCache.length?setTimeout(function(){e.width=e.domCache.width(),e.btnWidth=16,e.maxLeft=e.width-e.btnWidth,e.offsetX=e.domCache.offset().left,e.stepWidth=0;e.param=$.extend({value:0,disabled:!1,step:0,min:0,max:100,tips:"",change:null},a),e.run()},50):console.log("没有"+this.dom+"元素，滑块不再创建")}return _createClass(i,[{key:"run",value:function(){this._create(),this.param.disabled||this._event()}},{key:"_create",value:function(){function t(t){t.hasClass("slider")||t.addClass("slider"),n.param.disabled&&t.addClass("slider-disabled");var e="",a=void 0;if(0<n.param.step){n.stepWidth=_.round(n.width/n.param.step);for(var i=1;i<n.param.step;i++)e+='<div class="step" style="left: '+n.stepWidth*i+'px;"></div>';a=n.param.value/n.param.step*n.stepWidth,(a=(a-=8)<0?0:a)>n.maxLeft&&(a=n.maxLeft)}else a=_.floor(n.maxLeft/(n.param.max-n.param.min)*n.param.value);var s=n.param.value;0==s&&(s=n.param.min),""!=n.param.tips&&(s=_.replace(n.param.tips,"[val]",s)),e+='<div class="slider-btn'+(n.param.disabled?" tips-disabled":"")+'" data-tips="'+s+'" data-tips-offset="middle" \n\t\t\t\t\t\tdata-tips-center="1" style="left:'+a+'px;">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="slider-bar" style="width:'+(a+n.btnWidth)+'px;"></div>',t.html(e)}var n=this;1==this.domCache.length?t(this.domCache):this.domCache.each(function(){t($(this))})}},{key:"_event",value:function(){var n=this,l=0;n.domCache.on("mouseenter",".slider-btn",function(){$(this).data("active",1)}).on("mouseleave",".slider-btn",function(){$(this).data("active",0)}).on("mousedown",".slider-btn",function(t){var e=$(this),a={clientX:null,clientXClone:t.clientX,allow:!0,timer:null,val:0};a.left=parseInt(e.css("left")),a.bar=e.next(".slider-bar"),e.addClass("tips-disabled"),selectEnabled&&userselect(0),$(document).bind("mousemove",function(t){if(a.clientX=t.clientX-a.clientXClone,(l=a.left+a.clientX)<0||l>n.maxLeft){if(!a.allow)return;l=n._checkLeft(l),a.allow=!1}else a.allow=!0;0<n.param.step?(l==n.maxLeft?(l=n.maxLeft,a.val=n.param.max):(t=n._stepVal(l),a.val=t.val,l=t.left),e.css("left",l),a.bar.width(l+n.btnWidth)):(e.css("left",l),a.bar.width(l+n.btnWidth),a.val=n._val(l),a.val+=n.param.min),clearTimeout(a.timer),n._tips(a.val,e),Tips.reset(e,{offset:"middle"}),a.timer=setTimeout(function(){null!=n.param.change&&_.isFunction(n.param.change)&&n.param.change(a.val)},400)}).bind("mouseup",function(){e.removeClass("tips-disabled"),0==e.data("active")&&Tips.destory(e),$(this).unbind("mousemove").unbind("mouseup")})}).on("mouseup",".slider-btn",function(){selectEnabled&&userselect(1),$(this).parent().data("btn",!0)}).on("click",function(t){var e,a,i=$(this),s={val:0};1!=i.data("btn")?(l=_.floor(t.clientX-n.offsetX),l-=n.btnWidth/2,l=n._checkLeft(l),e=i.children(".slider-btn"),a=i.children(".slider-bar"),0==n.param.step?s.val=n._val(l):l!=n.maxLeft?(t=n._stepVal(l),s.val=t.val,l=t.left):s.val=n.param.max,e.css("left",l),a.width(l+n.btnWidth),n._tips(s.val,e),null!=n.param.change&&_.isFunction(n.param.change)&&n.param.change(s.val)):i.data("btn",!1)})}},{key:"_tips",value:function(t,e){""!=this.param.tips&&(t=_.replace(this.param.tips,"[val]",t)),e.data("tips",t)}},{key:"_checkLeft",value:function(t){return t=(t=t<0?0:t)>this.maxLeft?this.maxLeft:t}},{key:"_val",value:function(t){return _.floor((this.param.max-this.param.min)/this.maxLeft*t)}},{key:"_stepVal",value:function(t){var e=0,t=parseInt((t+this.btnWidth/2)/this.stepWidth);return 0<(e=t*this.stepWidth)&&(e-=this.btnWidth/2),{val:t*this.param.step,left:e}}}]),i}();