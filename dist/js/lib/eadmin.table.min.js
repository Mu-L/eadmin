/*!
 eadmin极速后台UI框架（我只想要个后台） | @author:317953536@qq.com 
*/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Table=function(){function i(t,e){if(_classCallCheck(this,i),this.domCache=scope(t),0!=this.domCache.length){this.window=null!=Mount.window?"#"+Mount.window:null,this.dom=null!=this.window?this.window+" "+t:t,this.storeKey=md5(Eadmin.currentHref),this.page=1;var a=store(this.storeKey+"_page");null!=a&&(this.page=+a),this.size=10,this.pageCount=null,this.searchBox=null,this.toolsBox=null,this.pageBox=null,this.table=null,this.shade=null,this.init=!1,this.btns=[],this.checked=0,this.get={},this.query="",this.width=+this.domCache.width(),this.scroll=null,this.columnId="column-config-"+createId(),this.column=[],this.columnConfig=store(this.storeKey+"_column"),this.columnConfig=null==this.columnConfig?{}:JSON.parse(this.columnConfig),this.exportExcel="exportExcel_"+createId(),this.excelColumn={};this.color=["#0084ff","#FF1844","#76FF02","#FFFF01","#FF7C00","#F52394","#00B2D4","#800080","#593110"];if(this.param=$.extend(!0,{config:{checkbox:!1,column_config:!1,export_excel:!1,fixed:{first:!1,last:!1},page:{size:10,num:5,page_field:"page",size_field:"size",show_message:!0},data:""},button:[],column:[],search:{},callback:null},e),!_.isBoolean(this.param.config.page)){var n=store(this.storeKey+"_size");null!=n&&(this.param.config.page.size=+n),this.size=this.param.config.page.size,this.get[this.param.config.page.page_field]=this.page,this.get[this.param.config.page.size_field]=this.size}this.domCache.addClass("table").hide().before('<div class="table-shade">\n\t\t\t\t\t\t<i class="ri-loader-4-line rotate"></i>数据加载中，请稍候...\n\t\t\t\t\t</div>'),this.shade=this.domCache.prev(".table-shade"),this.haveFixed=this.param.config.fixed.first,this.run()}else console.log("没有找到表格容器"+t+"，创建失败")}return _createClass(i,[{key:"run",value:function(){0!=this.param.column.length?""!=this.param.config.data?(this._create(),this._event(),this._resize()):console.log("没有指定数据源地址，无法创建表格"):console.log("至少为表格添加一列才可以创建表格")}},{key:"refresh",value:function(){this._loadData(!1)}},{key:"_create",value:function(){var l=this,i="",c=[],o={order:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a="";return!0===t&&(a='<span class="order">\n\t\t\t\t\t\t\t\t<i class="ri-arrow-up-s-line asc" data-order="'+e+',asc"></i>\n\t\t\t\t\t\t\t\t<i class="ri-arrow-down-s-line desc" data-order="'+e+',desc"></i>\n\t\t\t\t\t\t\t</span>'),a},head:function(){i+="<thead><tr>",i+=l._checkbox(),_.each(l.param.column,function(a,t){if(!0===a.search&&c.push(t),!1===a.column)return!0;var e=!0,n=0==t||t+1==l.param.column.length;null!=l.columnConfig[a.field]&&(e=l.columnConfig[a.field]),i+='<td class="td-'+t+(e?"":" dn")+'">\n\t\t\t\t\t\t\t\t'+a.name+o.order(a.order,a.field)+"\n\t\t\t\t\t\t\t</td>",l.column.push({name:a.name,disabled:n,checked:e,click:function(t){var e=l.table.t.find(".td-"+t._index);t._checked?e.show():e.hide(),l.columnConfig[a.field]=t._checked,store(l.storeKey+"_column",JSON.stringify(l.columnConfig))}}),null!=a.field&&(l.excelColumn[a.field]=a.name)}),i+="</tr></thead>"},search:function(){if(0!=c.length){var i='<div class="table-search dn">\n\t\t\t\t\t\t<form>\n\t\t\t\t\t\t\t<div class="block-box table-search-box">',o=[];_.each(c,function(t,e){i+='<div class="col-3"><div class="form-group">';var a=l.param.column[t];if(null==l.param.search[a.field])i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t<input name="'+a.field+'" type="text" placeholder="请输入'+a.name+'">\n\t\t\t\t\t\t\t\t</div>';else{var n=l.param.search[a.field];switch(n.type){case"select":i+='<select name="'+a.field+'" data-width="100%" data-custom-txt="'+a.name+'">\n\t\t\t\t\t\t\t\t\t\t\t<option value="">\n\t\t\t\t\t\t\t\t\t\t\t\t请选择'+a.name+"\n\t\t\t\t\t\t\t\t\t\t\t</option>",_.each(n.option,function(t){i+='<option value="'+t.val+'">\n\t\t\t\t\t\t\t\t\t\t\t\t'+t.key+"\n\t\t\t\t\t\t\t\t\t\t\t</option>"}),i+="</select>";break;case"datepicker":i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\t\tid="table-datepicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\t\tclass="table-datepicker"\n\t\t\t\t\t\t\t\t\t\t\t\tname="'+a.field+'" \n\t\t\t\t\t\t\t\t\t\t\t\tdata-key="'+e+'"\n\t\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+a.name+'">\n\t\t\t\t\t\t\t\t\t\t</div>',o[e]=n.param;break;case"citypicker":i+='<div class="input-group">\n\t\t\t\t\t\t\t\t\t\t\t<span class="prepend">'+a.name+'</span>\n\t\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\t\tid="table-citypicker-'+e+'" \n\t\t\t\t\t\t\t\t\t\t\t\tclass="table-citypicker"\n\t\t\t\t\t\t\t\t\t\t\t\tname="'+a.field+'" \n\t\t\t\t\t\t\t\t\t\t\t\tdata-key="'+e+'"\n\t\t\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder="请选择'+a.name+'">\n\t\t\t\t\t\t\t\t\t\t</div>',o[e]=n.param}}i+="</div></div>"}),i+='<div class="col-3">\n\t\t\t\t\t\t\t<button class="search-do highlight middle">\n\t\t\t\t\t\t\t\t<i class="ri-search-line"></i>搜索\n\t\t\t\t\t\t\t</button><button class="search-refresh middle">\n\t\t\t\t\t\t\t\t<i class="ri-refresh-line"></i>重置\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div></form></div>',l.domCache.before(i),l.searchBox=l.domCache.prev(".table-search"),l.searchBox.find(".table-datepicker").each(function(){var t=$(this);Eadmin.datepicker("#"+t.attr("id"),o[t.data("key")])}),l.searchBox.find(".table-citypicker").each(function(){var t=$(this);Eadmin.citypicker("#"+t.attr("id"),o[t.data("key")])})}},tools:function(){if(0!=l.param.button.length||l.param.config.column_config||l.param.config.export_excel){var a='<div class="table-tools dn">';_.each(l.param.button,function(t,e){a+='<button id="table-btn-'+e+'" ',a+=0==e?'class="highlight middle">':'class="middle">',null!=t.icon&&(a+='<i class="'+t.icon+'"></i>'),a+=t.name+"</button>"}),l.param.config.export_excel&&(a+='<button \n\t\t\t\t\t\t\t\tid="export-excel" \n\t\t\t\t\t\t\t\tclass="middle" \n\t\t\t\t\t\t\t\tdata-loading="数据导出中..." \n\t\t\t\t\t\t\t\tdata-do="'+l.exportExcel+'">\n\t\t\t\t\t\t\t\t<i class="ri-download-2-line"></i>导出excel\n\t\t\t\t\t\t\t</button>'),l.param.config.column_config&&(a+='<button id="'+l.columnId+'" class="middle mr0 fr">\n\t\t\t\t\t\t\t\t<i class="ri-settings-2-line"></i>表头\n\t\t\t\t\t\t\t</button>'),a+="</div>",l.domCache.before(a),l.toolsBox=l.domCache.prev(".table-tools")}},page:function(){if(!_.isBoolean(l.param.config.page)){var t='<div class="table-page dn">\n\t\t\t\t\t\t\t\t<span class="info">\n\t\t\t\t\t\t\t\t\t共<em></em>条，每页\n\t\t\t\t\t\t\t\t\t<select name="pagesize" data-width="70">\n\t\t\t\t\t\t\t\t\t\t<option value="0">请选择</option>\n\t\t\t\t\t\t\t\t\t\t<option value="10"'+(10==l.size?" selected":"")+'>10</option>\n\t\t\t\t\t\t\t\t\t\t<option value="30"'+(30==l.size?" selected":"")+'>30</option>\n\t\t\t\t\t\t\t\t\t\t<option value="50"'+(50==l.size?" selected":"")+'>50</option>\n\t\t\t\t\t\t\t\t\t\t<option value="100"'+(100==l.size?" selected":"")+">100</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t条，当前 <em>"+l.page+'</em>/<em>-</em> 页\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="prev-page"><i class="ri-arrow-left-s-line"></i></span>\n\t\t\t\t\t\t\t\t<span class="next-page"><i class="ri-arrow-right-s-line"></i></span>\n\t\t\t\t\t\t\t\t<span class="jump">\n\t\t\t\t\t\t\t\t\t跳转到第 <input name="page" type="text" placeholder="页数"> 页\n\t\t\t\t\t\t\t\t\t<button class="highlight small">确定</button>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>';l.domCache.after(t),l.pageBox=l.domCache.next(".table-page")}},fixed:function(){var t="";if(l.param.config.fixed.first){t+='<div class="fixed-left"><table><thead><tr>',t+=l._checkbox(null,!0);var e=_.head(l.param.column);t+="<td>"+e.name+o.order(e.order,e.field)+"</td></tr></thead>",t+="<tbody></tbody></table></div>"}if(l.param.config.fixed.last){t+='<div class="fixed-right"><table><thead><tr>';var a=_.last(l.param.column);t+="<td>"+a.name+o.order(a.order,a.field)+"</td></tr></thead>",t+="<tbody></tbody></table></div>"}l.domCache.append(t)},body:function(){o.head(),o.search(),o.tools(),o.page(),i+="<tbody></tbody></table></div>",l.domCache.html(i),o.fixed(),0!=l.param.button.length||l.param.config.column_config||l.param.config.export_excel||l.domCache.find("thead > tr").addClass("head-border-top"),l.table={head:l.domCache.find("thead"),body:l.domCache.find("tbody"),lbox:l.domCache.find(".fixed-left"),rbox:l.domCache.find(".fixed-right"),box:l.domCache.find(".table-box")},l.table.t=l.table.box.children("table"),l.table.c=l.table.t.children("tbody"),l.table.l=l.table.lbox.find("tbody"),l.table.r=l.table.rbox.find("tbody")}};i='<div class="table-box" style="width:'+this.width+'px;"><table style="width:'+this.width+'px;">',o.body(),this._loadData()}},{key:"_event",value:function(){var n=this,t=["thead .checkall","tbody .checkall","tbody tr",".search-do",".search-refresh",".table-page select",".table-page .num-page:not(.current)",".table-page .prev-page",".table-page .next-page",".table-page button",".table-tools button",".order i:not(.active)",'[data-model="switch"]',".column-btn"],e=function(t){Eadmin.message.error({content:t}),o.pageBox.find("input").val("")},a=[this,this.domCache.parent()],o=a[0],i=a[1];if(o.param.config.checkbox&&i.on("click",t[0],function(){var t=[$(this),{}],e=t[0],a=t[1];a.isCheck=e.is(":checked")?1:0,o.checked=1==a.isCheck?o.size:0,a.checkbox=o.haveFixed?o.table.l.find(".checkall"):o.table.t.find(".checkall"),Form.checkbox(a.checkbox,a.isCheck)}).on("click",t[1],function(){var t,e=[$(this),0],a=e[0];o.checked+=a.is(":checked")?1:-1,t=o.checked==o.size?1:0,Form.checkbox(o.table.head.find(".checkall"),t)}),o.param.config.fixed.first||o.param.config.fixed.last){var l=0;i.on("mouseenter",t[2],function(){l=$(this).index(),o.table.c.children("tr").eq(l).addClass("tr-hover"),o.table.l.children("tr").eq(l).addClass("tr-hover"),o.table.r.children("tr").eq(l).addClass("tr-hover")}).on("mouseleave",t[2],function(){o.table.c.children("tr").eq(l).removeClass("tr-hover"),o.table.l.children("tr").eq(l).removeClass("tr-hover"),o.table.r.children("tr").eq(l).removeClass("tr-hover")})}if(null!=o.searchBox&&i.on("click",t[3],function(){o.page=1,o.get[o.param.config.page.page_field]=o.page,_.unset(o.get,"_export");var t=o.searchBox.children("form").serialize();t!=o.query&&(o.get._search=1,o.query=t);var e=_.split(t,"&");return _.each(e,function(t){var e=_.split(t,"=");o.get[e[0]]=decodeURIComponent(e[1])}),o._loadData(!0),!1}).on("click",t[4],function(){return o.searchBox.find("input").val(""),Form.select(o.searchBox),!1}),null!=o.toolsBox&&_.each(o.param.button,function(i,t){var e=o.toolsBox.find("button").eq(t);if(null!=i.open){e.data("window-url",i.open.url);var a=e.attr("id");return Eadmin.window("#"+a,i.open),!0}e.on("click",function(){if(!0!==i.check_checked||0!=o.checked){var t=function(){var t=[[],{}],e=t[0],a=t[1],n=t[2];if(0<(n=(n=o.haveFixed?o.table.l:o.table.c).find(".checkall:checked")).length&&(n.each(function(){e.push($(this).val())}),e=_.toString(e),a[o.param.config.checkbox]=e),null!=i.api)return Eadmin.get({url:i.api,param:a,popup:!0,then:function(){!0===i.refresh&&o._loadData()}}),!0;_.isFunction(i.callback)?i.callback(_.isArray(e)?"":e):console.log("按钮操作没有指明具体操作动作，无法执行")};if(!0===i.confirm)return Eadmin.popup.confirm({content:"确认执行此操作吗？",callback:t}),!0;t()}else Eadmin.popup.error({content:"请至少选择一项执行此操作"})})}),_.isBoolean(this.param.config.page)||i.on("change",t[5],function(){o.page=1,o.size=+$(this).val(),store(o.storeKey+"_page",o.page.toString()),store(o.storeKey+"_size",o.size.toString()),o.get[o.param.config.page.page_field]=o.page,o.get[o.param.config.page.size_field]=o.size,o._loadData(!0)}).on("click",t[6],function(){o.page=+$(this).html(),store(o.storeKey+"_page",o.page.toString()),o.get[o.param.config.page.page_field]=o.page,o._loadData(!0)}).on("click",t[7],function(){1!=o.page&&(o.page-=1,store(o.storeKey+"_page",o.page.toString()),o.get[o.param.config.page.page_field]=o.page,o._loadData(!0))}).on("click",t[8],function(){o.page!=o.pageCount&&(o.page+=1,store(o.storeKey+"_page",o.page.toString()),o.get[o.param.config.page.page_field]=o.page,o._loadData(!0))}).on("click",t[9],function(){var t=o.pageBox.find("input").val();""!=t?t<1?e("跳转的页数不能小于1"):t>o.pageCount?e("跳转的页数已经超出了最大页数"):t!=o.page?(store(o.storeKey+"_page",t),o.page=+t,o.get[o.param.config.page.page_field]=o.page,o._loadData(!0)):e("已经在待跳转的页面了"):e("跳转的页数不能为空")}),i.on("click",t[11],function(){var t=$(this);o.table.head.find(".active").removeClass("active"),t.addClass("active"),o.get.order=t.data("order"),o._loadData(!0)}).on("click",t[12],function(){var t=[$(this),{}],e=t[0],a=t[1];a.label=e.parent("label"),a.api=a.label.data("api"),a.field=a.label.data("field"),a.val=e.val(),a.param={},a.param[a.field]=a.val,Eadmin.get({url:a.api,param:a.param,popup:!0})}).on("click",t[13],function(){var t=[$(this),{}],e=t[0],a=t[1];if(a.row=e.data("row"),a.key=e.data("key"),a.btn=o.btns[a.row][a.key],null==a.btn.open){if(null!=a.btn.api){var n=function(){Eadmin.get({url:a.btn.api,popup:!0,then:function(){!0===a.btn.refresh&&o._loadData()}})};if(!0===a.btn.confirm)return void Eadmin.popup.confirm({content:"确定执行此操作吗？",callback:n});n()}}else Eadmin.window(!1,a.btn.open)}),this.param.config.column_config&&Eadmin.dropdown("#"+this.columnId,{width:200,title:"表头设置",data:this.column}),this.param.config.export_excel){var c=function(t,e){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,e);else{"object"==(void 0===t?"undefined":_typeof(t))&&t instanceof Blob&&(t=URL.createObjectURL(t));var a=document.createElement("a");a.href=t,a.download=e||"";var n=void 0;window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}},s=function(t){var e={SheetNames:["sheet1"],Sheets:{}};e.Sheets.sheet1=t;var a=XLSX.write(e,{bookType:"xlsx",bookSST:!0,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}(a)],{type:"application/octet-stream"})};Method[this.exportExcel]=function(a){n.get._export=1,Eadmin.get({url:n.param.config.data,param:n.get,then:function(t){t=[n.excelColumn].concat(_toConsumableArray(t.list));var e=XLSX.utils.json_to_sheet(t,{skipHeader:!0});c(s(e),createId()+".xlsx"),Eadmin.button.reset(a)}})}}}},{key:"_checkbox",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return!1===this.param.config.checkbox?"":null==t?'<td class="td-checkbox"><div>\n\t\t\t\t\t\t<label class="checkall-box">\n\t\t\t\t\t\t\t<input type="checkbox" class="checkall">\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div></td>':null==t[this.param.config.checkbox]?(console.log("复选框绑定的字段"+this.param.config.checkbox+"不存在"),""):'<td class="td-checkbox"><div>\n\t\t\t\t\t<label class="checkall-box">\n\t\t\t\t\t\t<input type="checkbox" class="checkall" value="'+t[this.param.config.checkbox]+'">\n\t\t\t\t\t</label>\n\t\t\t\t</div></td>'}},{key:"_page",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!_.isBoolean(this.param.config.page))if(_.has(t,"count")){this.init||this.pageBox.data("size",this.size);var a={count:this.pageBox.find("em:first"),page:this.pageBox.find("em").eq(1),pageCount:this.pageBox.find("em").eq(2)};t.count==+a.count.html()&&this.size==this.pageBox.data("size")||(t.count<this.size?this.pageCount=1:t.count%this.size==0?this.pageCount=t.count/this.size:this.pageCount=parseInt(t.count/this.size)+1,a.count.html(t.count),a.pageCount.html(this.pageCount),this.size!=this.pageBox.data("size")&&this.pageBox.data("size",this.size)),a.page.html(this.page);var n=10;_.has(this.param.config.page,"num")&&((n=this.param.config.page.num)<3&&(n=3),10<n&&(n=10));var i="",o=this.page,l=n+((o-=_.floor(n/2))<1?(o=1,0):this.page-_.floor(n/2)-1);l>this.pageCount&&(l=this.pageCount),l-o<n-1&&(o-=n-(l-o)-1),o<1&&(o=1);for(var c=o;c<=l;c++)i+='<span class="num-page'+(c==this.page?" current":"")+'" data-page="'+c+'">'+c+"</span>";this.pageBox.find(".num-page").remove(),this.pageBox.find(".prev-page").after(i),this.init&&e&&this.param.config.page.show_message&&Eadmin.message.success({content:"当前第 "+this.page+" 页，共 "+this.pageCount+" 页"})}else console.log("数据源中未包含数据总条数count字段，创建分页失败")}},{key:"_loadData",value:function(){var u=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0],f=this;this.checked=0,this.btns=[],this.shade.css("display","flex"),this.table.lbox.hide(),this.table.rbox.hide(),null!=this.searchBox&&this.searchBox.hide(),null!=this.toolsBox&&this.toolsBox.hide(),this.domCache.hide(),!1!==this.param.config.page&&this.pageBox.hide(),this.table.c.empty(),i&&(null!=this.window?_.startsWith(this.window,"#tab")||($(this.window+" .body")[0].scrollTop=0):box[0].scrollTop=0),Eadmin.get({url:this.param.config.data,param:this.get,then:function(t){var l={data:t,html:"",fl:"",fr:""},c=function(t,e){return!0===t.tag?' data-tag="'+e[t.field]+'"':""},s=function(t,e){var a="";return _.isFunction(t.api)?a=t.api(e):console.log("没有指定保存开关状态的API地址"),'<label class="no-padding" data-api="'+a+'" data-field="'+t.field+'">\n\t\t\t\t\t\t\t\t\t<input type="radio" data-model="switch" value="'+e[t.field]+'">\n\t\t\t\t\t\t\t\t</label>'},r=function(t,e,s){var a=t.button(e);f.btns.push(a);var r="";return _.each(a,function(t,e){var a=[null!=t.icon?'<i class="'+t.icon+'"></i>':"","table-column-btn-"+s+"-"+e,null!=t.open?t.open.url:"","",""],n=a[0],i=a[1],o=a[2],l=a[3],c=!0===t.disabled?" disabled":"";r+='<button \n\t\t\t\t\t\t\t\t\t\tid="'+i+'" \n\t\t\t\t\t\t\t\t\t\t'+c+'\n\t\t\t\t\t\t\t\t\t\tdata-row="'+s+'" \n\t\t\t\t\t\t\t\t\t\tdata-key="'+e+'" \n\t\t\t\t\t\t\t\t\t\tdata-window-url="'+o+'"\n\t\t\t\t\t\t\t\t\t\tclass="small column-btn'+l+'" \n\t\t\t\t\t\t\t\t\t\tstyle="background:'+f.color[e]+"; border-color:"+f.color[e]+';"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t'+n+" "+t.name+"\n\t\t\t\t\t\t\t\t\t</button>"}),r},d=function(t,e){var a="";return a+='<img src="'+(_.isFunction(t.format)?t.format(e):e[t.field])+'"',!0===t.head&&(a+=' class="table-img-head"'),a+=">"},h=function(t,e){return _.isFunction(t.format)?t.format(e):e[t.field]},p=function(t,e){if(!_.isFunction(t.link))return"";if(_.isBoolean(t)&&t)return"</a>";var a=t.link(e),n='<a href="'+a.href+'"';return!0===a.native&&(n+=" data-native"),null!=a.target&&(n+=' target="'+a.target+'"'),null!=a.windowUrl&&(n+=' data-window-url="'+a.windowUrl+'"'),null!=a.class&&(n+=' class="'+a.class+'"'),n+=">"};if(null!=l.data.count||!1===u.param.config.page)if(null!=l.data.list){if(0<l.data.list.length){_.each(l.data.list,function(i,o){l.fl+="<tr>",l.fr+="<tr>",l.html+="<tr>",l.html+=u._checkbox(i),l.fl+=u._checkbox(i,!0),_.each(u.param.column,function(t,e){if(!1===t.column)return!0;var a="<td";a+=c(t,i);var n=!0;null!=u.columnConfig[t.field]&&(n=u.columnConfig[t.field]),a+=' class="td-'+e+(n?"":" dn")+'">',!0===t.switch?a+=s(t,i):_.isFunction(t.button)?a+=r(t,i,o):(a+=p(t,i),a+=!0===t.img?d(t,i):h(t,i),a+=p(!0)),a+="</td>",0==e&&(l.fl+=a),l.html+=a,e+1==u.param.column.length&&(l.fr+=a)}),l.fl+="</tr>",l.html+="</tr>",l.fr+="</tr>"}),u.table.c.html(l.html),defaultImg(u.table.c),-1!=module.lib.indexOf("tag")&&Tag.run(u.table.c),u.table.t.width()<=u.width?(u.table.lbox.remove(),u.table.rbox.remove(),u.haveFixed=!1):(!0===u.param.config.fixed.first&&(u.table.head.eq(0).find(".checkall-box").remove(),u.table.c.find(".checkall-box").remove(),u.table.l.html(l.fl),Eadmin.form(u.table.l)),!0===u.param.config.fixed.last&&(u.table.r.html(l.fr),Eadmin.form(u.table.r))),Eadmin.form(u.table.c),-1!=module.lib.indexOf("progress")&&Progress.run(u.table.c),u._page(l.data,i);var e=u.table.head.find(":checkbox");e.is(":checked")&&Form.checkbox(e,!1),u.domCache.show(),null!=u.searchBox&&u.searchBox.show(),null!=u.toolsBox&&u.toolsBox.show(),!1!==u.param.config.page&&u.pageBox.show(),u.table.lbox.show(),u.table.rbox.show();var a=u.domCache.find(".empty");0<a.length&&a.hide()}else{!1!==u.param.config.page&&u.pageBox.hide();var n=u.domCache.find(".empty");0==n.length?u.domCache.append('<div class="empty">该列表暂无更多数据~</div>'):n.show()}u.shade.hide(),null!=u.param.callback&&u.param.callback(l.data),u.get._search=0,u.init||(u.scroll=Eadmin.scroll(u.dom+" .table-box","x"),u.table.t.width()<=u.width?u.table.t.width(u.width):u.domCache.children(".table-box").css("padding-bottom","18px"),u.init=!0)}else console.log("数据源中没有包含list字段，创建表格失败");else console.log("返回的数据源中没有 count 字段，无法使用分页，请在配置中设置 page 为 false")}})}},{key:"_resize",value:function(){var t=this;$(window).on("resize",_.debounce(function(){t.width=+t.domCache.width(),t.table.box.width(t.width),t.table.t.width()<=t.width?(t.table.t.width(t.width),t.domCache.children(".table-box").css("padding-bottom",0)):t.domCache.children(".table-box").css("padding-bottom","18px"),null!=t.scroll&&t.scroll.update()},100))}}]),i}();